= システム構成

ここでは、前章で述べた設計について実現した具体的なハードウェア・ソフトウェア構成を示す。

== ハードウェア構成

本システムの主要コンポーネントに小型のコンピュータであるRaspberry Pi財団のシングルボードコンピュータRaspberry Pi Zero 2 W@raspberry_pi_zero_2_w_product_page を利用する。また、提示装置にはWaveshare社の7.5inch HD e-Paper HAT (B)@waveshare_7_5inch_hd_e_paper_hat_wiki を採用する。実際に生成に関わるコンポーネントは以上の2つであるが、制作する装置には加えて、実行するためのプッシュスイッチ、時刻・位置情報を鑑賞者に提示するための7セグメントLEDを搭載する。

== ソフトウェア構成

Raspberry Pi上で実行される描画のためのスクリプトはPythonによって記述する。描画に関わる変数として取得する値は、実行される時刻、実行される場所、実行ボタンが押される時間の3種類で、以下のように値を利用する。
本装置上で動作するスクリプトはGitHub上で公開している。#footnote[https://github.com/menma275/createdAt]

- 時刻: UNIX Time
  + 実行された時刻を10進数のUNIX Timeとして取得
  + ハッシュ化によって2進数化
    - Pythonライブラリhashlib@python_docs_hashlib から提供される以下の10のハッシュ化手法を利用
      - md5
      - sha1
      - sha224
      - sha256
      - sha384
      - sha512
      - sha3_224
      - sha3_256
      - sha3_384
      - sha3_512
  + 画素情報とする
    - 2進数化した値を電子ペーパーのピクセル数を満たすまで複製
- 場所: 緯度経度
  + 実行された場所の緯度経度を2つの値として取得(lat, lng)
    - Pythonライブラリgeocoder@geocoder_readthedocs を利用
  - 時刻情報を2進数化するハッシュ化関数の選定
    - `(lat*100+lng*100)%11`によって得られる11種類の値からハッシュ化関数を決定、もしくはハッシュ化を用いないかを決定
  - 描画表現の選定
    - `(lat*100+lng*100)%2===0`によって得られる真偽値から以下の描画処理から1つを選定
      + 2進数を電子ペーパーのピクセル数を満たすまで複製した配列
      + 1を元にPerlin Noise@elias_perlin_noise_model を利用して複雑化したもの
  - Perlin Noise使用時の変数決定
    - noiseScale
      - Perlin Noise全体のスケール率
      - `0.01 + ((lat+lng) - math.floor(lat+lng)) * 0.09`
    - noiseScaleX
      - Perlin Noise X軸のスケール率
      - `0.01 + ((lat) - math.floor(lat)) * 0.09`
    - noiseScaleY
      - Perlin Noise Y軸のスケール率
      - `0.01 + ((lng) - math.floor(lng)) * 0.09`
- 時間: プッシュスイッチの押下時間
  + 実行のために使用されるプッシュスイッチを押下した長さを取得
  + 取得した秒数を整数化
  + 時刻によって決定される2進数によるピクセル情報の拡大率とする
    - n倍の場合: nピクセル四方で1ピクセルとして扱う

== 実行例
実行環境として東京都日野市（緯度: 35.6731、経度: 139.4003）において、2026年2月23日13時12分41秒（UNIX Time: 1771819961.37）に、ボタンを6.068秒間押下した場合の生成過程を示す。

まず場所情報から内部変数seedを|lat × 100 + lng × 100| = 17507.34として算出する。Hash Modeは17507.34 % 11 ≒ 6、Perlinの判定はint(17507.34) % 2 = 1よりFalse、すなわちPerlin Noiseを用いない複製描画が採用された。各スケール率はnoiseScale: 0.016606、noiseScaleX: 0.070579、noiseScaleY: 0.046027と決定された。押下時間6.068秒からblock_sizeはint(6.068) = 6と決定された。

生成結果は@example のようになった。

バッファの生成には約1.2秒、電子ペーパーへの描画には約26.7秒を要した。生成された画素情報は描画完了と同時に装置内から削除され、視覚表現は電子ペーパー上にのみ定着する。実行時刻・場所・押下時間のいずれか1つが異なるだけで全く別の描画結果となり、同一の結果を再生成することはできない。

#figure(
  image("../images/example.jpg", width: 80%),
  caption: [生成結果],
) <example>
